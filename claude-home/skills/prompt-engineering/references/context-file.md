## Context File リファレンス

**配置**: プロジェクトルートの `CLAUDE.md` または `.claude/CLAUDE.md`
**ロード**: セッション開始時に自動読み込み（毎回全量消費）

### ロード順序と優先度

```
~/.claude/CLAUDE.md                  ← ユーザーグローバル設定
.claude/CLAUDE.md                    ← プロジェクト設定（Git管理）
CLAUDE.md                            ← プロジェクトルート（Git管理）
~/.claude/projects/<hash>/CLAUDE.md  ← ユーザーローカル上書き
```

同名キーは後からロードされたファイルが優先。

### 設計原則

| 原則 | 説明 |
|------|------|
| **80%ルール** | タスクの80%が参照する情報のみ。稀にしか必要でない情報は references/ に |
| **100行未満** | 毎回ロードされるためトークンコストに直結 |
| **インデックス優先** | 詳細はポインタ（`docs/architecture.md 参照`）で案内 |
| **コマンドの吟味** | LLM が自律実行するコマンドのみ記載。人間用手順は docs/ に |

### 推奨構造

```markdown
## プロジェクト概要（1-2文）

## 開発コマンド
[最小限の頻出コマンド]

## 設計原則
[3-5個の箇条書き]

## ディレクトリ構造
[主要ディレクトリのみ]

## 関連ドキュメント
| パス | 内容 |
|------|------|
| `docs/architecture.md` | 詳細設計 |
```

### 含めるべき情報

- プロジェクトの技術スタック（1行）
- ビルド・テスト・リントの実行コマンド
- ディレクトリ構造の概要
- 守るべき設計原則（3-5個）
- 詳細ドキュメントへのポインタ

### 含めるべきでない情報

- API仕様の詳細（→ references/ や docs/）
- 歴史的経緯・移行ログ
- チュートリアル・学習リソース
- CI/CD パイプラインの詳細設定
- 大きなコード例やテンプレート

### 悪い例

```markdown
## プロジェクト概要
[20行の詳細説明]

## アーキテクチャ
[50行の詳細設計]        ← docs/architecture.md に分離すべき

## API一覧
[100行のエンドポイント表] ← docs/api.md に分離すべき

## 移行ガイド
[30行の歴史]             ← 80%のタスクに不要
```

### 良い例（66行）

```markdown
## プロジェクト概要（1文）

## ディレクトリ構造
commands/ (196) / agents/ (95) / hooks/ (22) / skills/ (6)

## 実行方法
/dev:git-status    # Commands
Task: code-reviewer # Agents

## 設計原則
- ドメイン分離: 汎用=claude-home/、専用=.claude/
- レイヤード: Commands → Agents → Skills → Hooks

## 関連ドキュメント
| パス | 内容 |
|------|------|
| `docs/architecture.md` | 詳細設計 |
```

### 複数 CLAUDE.md の使い分け

| ファイル | 用途 | 例 |
|----------|------|----|
| `CLAUDE.md` | プロジェクト全体（チーム共有） | 技術スタック、コマンド、原則 |
| `.claude/CLAUDE.md` | Claude Code 固有設定 | エージェント一覧、スキル設定 |
| `~/.claude/CLAUDE.md` | ユーザー個人設定 | 言語設定、個人ワークフロー |
