# セキュリティ堅牢化手順

アプリケーションセキュリティ構成を以下の 10 ステップで堅牢化する。

## 1. セキュリティ評価とベースライン

脆弱性の特定には `security-audit.md` の手順を先に実施すること。

- 現在のアプリケーションの包括的セキュリティ監査を実施
- 潜在的な脆弱性と攻撃ベクトルを特定
- ネットワークセキュリティと通信プロトコルを評価

## 2. 認証・認可の堅牢化

認証システムの詳細な実装ガイドは `authentication.md` を参照。

- 強力なパスワードポリシーと多要素認証を実装
- 適切なタイムアウト付きセキュアセッション管理を設定
- 最小権限の原則に基づく RBAC を設定
- JWT セキュリティベストプラクティスまたはセキュアセッショントークンを実装
- アカウントロックアウトとブルートフォース防止を設定

## 3. 入力検証・サニタイゼーション

- 全ユーザー入力に対する包括的な入力検証を実装
- パラメータ化クエリによる SQL インジェクション防止を設定
- 適切な出力エンコードによる XSS 防止を設定
- トークンと SameSite Cookie による CSRF 防止を実装
- 型検証とサンドボックスによるファイルアップロードセキュリティを設定

## 4. セキュア通信

- 強力な TLS/SSL 証明書で HTTPS を設定
- HTTP Strict Transport Security (HSTS) を実装
- 適切な認証付きセキュア API 通信を設定
- モバイルアプリケーション用の証明書ピニングを設定
- 機密データ転送のエンドツーエンド暗号化を実装

## 5. データ保護・暗号化

- 機密データの保存時暗号化を実装
- セキュアな鍵管理とローテーションを設定
- データベース暗号化とアクセス制御を設定
- 適切なシークレット管理を実装 (ハードコード回避)
- セキュアなバックアップとリカバリ手順を設定

## 6. セキュリティヘッダー・ポリシー

- Content Security Policy (CSP) ヘッダーを設定
- X-Frame-Options、X-Content-Type-Options ヘッダーを設定
- Referrer Policy、Feature Policy ヘッダーを実装
- 適切なオリジン検証付き CORS ポリシーを設定
- 責任ある開示のための security.txt ファイルを設定

## 7. 依存関係・サプライチェーンセキュリティ

依存関係の詳細な監査は `dependency-audit.md` を参照。

- 全依存関係を最新のセキュアバージョンに更新
- 依存関係の脆弱性スキャンを実装
- 重要な依存関係の自動セキュリティ更新を設定
- ソフトウェアコンポジション分析 (SCA) ツールを設定
- 依存関係のピニングと整合性チェックを実装

## 8. インフラセキュリティ

- ファイアウォールルールとネットワークセグメンテーションを設定
- 侵入検知・防止システムを実装
- セキュアなログと監視を設定
- セキュアなコンテナイメージとランタイムセキュリティを設定
- Infrastructure as Code セキュリティスキャンを実装

## 9. アプリケーションセキュリティ制御

- レート制限と DDoS 防止を実装
- Web Application Firewall (WAF) ルールを設定
- 情報漏洩のないセキュアなエラーハンドリングを設定
- セキュリティイベントの適切なログを実装
- セキュリティ監視とアラートを設定

## 10. セキュリティテスト・検証

- ペネトレーションテストと脆弱性評価を実施
- CI/CD パイプラインに自動セキュリティテストを実装
- Static Application Security Testing (SAST) を設定
- Dynamic Application Security Testing (DAST) を設定
- セキュリティインシデント対応計画と手順を作成
- セキュリティ制御とコンプライアンス要件を文書化

See also: 堅牢化前の脆弱性特定には `security-audit.md` を参照。
