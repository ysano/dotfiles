# セキュリティ監査手順

包括的なセキュリティ評価を以下の 10 ステップで実施する。

## 1. 環境セットアップ

- 技術スタックとフレームワークを特定
- 既存のセキュリティツールと設定を確認
- デプロイメントとインフラ構成をレビュー

## 2. 依存関係セキュリティ

依存関係の詳細な監査は `dependency-audit.md` を参照。ここでは概要レベルで:

- 全依存関係の既知の脆弱性をスキャン
- セキュリティ問題のある古いパッケージを確認
- 適切なツールを使用: `npm audit`, `pip check`, `cargo audit` 等

## 3. 認証・認可

認証システムの詳細な実装ガイドは `authentication.md` を参照。ここでは監査観点で:

- 認証メカニズムと実装をレビュー
- 適切なセッション管理を確認
- 認可制御とアクセス制限を検証
- パスワードポリシーと保存方法を検査

## 4. 入力検証・サニタイゼーション

- 全ユーザー入力の検証とサニタイゼーションを確認
- SQL インジェクション脆弱性を検索
- XSS（クロスサイトスクリプティング）の可能性を特定
- ファイルアップロードのセキュリティと検証をレビュー

## 5. データ保護

- 機密データの取り扱い実態を特定
- 保存時・転送時の暗号化実装を確認
- データマスキングと匿名化の実態をレビュー
- セキュア通信プロトコル (HTTPS, TLS) を検証

## 6. シークレット管理

- ハードコードされたシークレット、API キー、パスワードをスキャン
- 適切なシークレット管理手法を確認
- 環境変数のセキュリティをレビュー
- 露出した設定ファイルを特定

## 7. エラーハンドリング・ログ

- エラーメッセージの情報漏洩をレビュー
- セキュリティイベントのログ記録を確認
- 機密データがログに記録されていないことを検証
- エラーハンドリングの堅牢性を評価

## 8. インフラセキュリティ

- コンテナ化セキュリティ (Docker 等) をレビュー
- CI/CD パイプラインのセキュリティを確認
- クラウド設定と権限を検査
- ネットワークセキュリティ構成を評価

## 9. セキュリティヘッダー・CORS

- セキュリティヘッダーの実装を確認
- CORS 設定をレビュー
- CSP (Content Security Policy) 設定を検証
- Cookie セキュリティ属性を検査

## 10. レポーティング

- 全発見事項を重大度レベル (Critical, High, Medium, Low) で文書化
- 各問題に具体的な修正手順を提供
- コード例とファイル参照を含める
- キーの推奨事項を含むエグゼクティブサマリーを作成

自動セキュリティスキャンツールが利用可能な場合は活用し、複雑なセキュリティパターンには手動レビューを提供する。

See also: 監査後の修正には `security-hardening.md` を参照。
