# コード解説コマンド

あらゆるプログラミング言語の複雑なコード部分を、明確で包括的な説明で分析し、解説します。

## 実行手順

コードを解説するために以下の体系的アプローチに従ってください：**$ARGUMENTS**

1. **コードコンテキスト分析**
   - プログラミング言語とフレームワークを特定する
   - コードのより幅広いコンテキストと目的を理解する
   - ファイルの場所とプロジェクト内での役割を特定する
   - 関連するimport、依存関係、設定をレビューする

2. **高レベル概要**
   - コードが何をするかの要約を提供する
   - 主な目的と機能を説明する
   - コードが解決している問題を特定する
   - より大きなシステムにどのように適合しているか説明する

3. **コード構造の分解**
   - コードを論理的なセクションに分解する
   - クラス、関数、メソッドを特定する
   - 全体的なアーキテクチャと設計パターンを説明する
   - データフローと制御フローをマッピングする

4. **行単位分析**
   - 複雑または自明でないコード行を説明する
   - 変数宣言とその目的を説明する
   - 関数呼び出しとそのパラメータを説明する
   - 条件ロジックとループを明確化する

5. **アルゴリズムとロジック説明**
   - 使用されているアルゴリズムやアプローチを説明する
   - 複雑な計算の背後にあるロジックを説明する
   - ネストした条件とループを分解する
   - 再帰的または非同期操作を明確化する

6. **データ構造と型**
   - 使用されているデータ型と構造を説明する
   - データがどのように変換または処理されるか説明する
   - オブジェクトの関係と階層を説明する
   - 入力と出力の形式を明確化する

7. **フレームワークとライブラリの使用**
   - フレームワーク固有のパターンと規約を説明する
   - ライブラリ関数とその目的を説明する
   - API呼び出しと期待されるレスポンスを説明する
   - 設定とセットアップコードを明確化する

8. **エラー処理とエッジケース**
   - エラー処理メカニズムを説明する
   - 例外処理と復旧を説明する
   - 処理されているエッジケースを特定する
   - バリデーションと防御的プログラミングを説明する

9. **パフォーマンスの考慮事項**
   - パフォーマンス重要セクションを特定する
   - 使用されている最適化技法を説明する
   - 複雑性とスケーラビリティの影響を説明する
   - 潜在的なボトルネックや非効率を指摘する

10. **セキュリティへの影響**
    - セキュリティ関連のコードセクションを特定する
    - 認証と許可ロジックを説明する
    - 入力検証とサニタイゼーションを説明する
    - 潜在的なセキュリティ脆弱性を指摘する

11. **テストとデバッグ**
    - コードをどのようにテストできるか説明する
    - デバッグポイントとログ出力を特定する
    - モックデータやテストシナリオを説明する
    - テストヘルパーとユーティリティを説明する

12. **依存関係と統合**
    - 外部サービス統合を説明する
    - データベース操作とクエリを説明する
    - APIの相互作用とプロトコルを説明する
    - サードパーティライブラリの使用を明確化する

**解説フォーマットの例:**

**複雑なアルゴリズムの場合:**
```
この関数は深さ優先探索アルゴリズムを実装しています:

1. 1-3行目: 開始ノードとvisitedセットでスタックを初期化
2. 4-8行目: メインループ - スタックが空になるまで継続
3. 9-11行目: ノードをポップし、ターゲットかどうかチェック
4. 12-15行目: 未訪問の隣接ノードをスタックに追加
5. 16行目: ターゲットが見つからない場合はnullを返す

時間計算量: O(V + E) ここでVは頂点、Eはエッジ
空間計算量: O(V) visitedセットとスタック用
```

**API統合コードの場合:**
```
このコードはサードパーティサービスでのユーザー認証を処理します:

1. リクエストヘッダーから認証情報を抽出
2. 認証情報の形式と必須フィールドを検証
3. 認証サービスへAPI呼び出しを実行
4. レスポンスを処理し、ユーザーデータを抽出
5. セッショントークンを作成し、cookieを設定
6. ユーザープロファイルまたはエラーレスポンスを返す

エラー処理: ネットワークエラー、無効な認証情報、サービス不可をキャッチ
セキュリティ: HTTPSを使用、入力検証、レスポンスのサニタイズ
```

**データベース操作の場合:**
```
この関数は結合を含む複雑なデータベースクエリを実行します:

1. プライマリテーブルでベースクエリを構築
2. 関連ユーザーデータのためのLEFT JOINを追加
3. フィルタリングのためのWHERE条件を適用
4. 一貫したソートのためのORDER BYを追加
5. LIMIT/OFFSETでページネーションを実装
6. クエリを実行し、潜在的なエラーを処理
7. 生の結果をドメインオブジェクトに変換

パフォーマンス備考: フィルタされた列のインデックスを使用、コネクションプーリングを実装
```

13. **一般的なパターンと慣用句**
    - 言語固有のパターンと慣用句を特定する
    - 実装されている設計パターンを説明する
    - 使用中のアーキテクチャパターンを説明する
    - 命名規約とコードスタイルを明確化する

14. **潜在的な改善点**
    - コードの改善と最適化を提案する
    - リファクタリングの機会を特定する
    - 保守性の懸念を指摘する
    - ベストプラクティスと標準を推奨する

15. **関連コードとコンテキスト**
    - 関連関数とクラスを参照する
    - このコードが他のコンポーネントとどのように相互作用するか説明する
    - 呼び出しコンテキストと使用パターンを説明する
    - 関連ドキュメンテーションとリソースを示す

16. **デバッグとトラブルシューティング**
    - このコードの問題をデバッグする方法を説明する
    - 一般的な失敗ポイントを特定する
    - ログ出力と監視アプローチを説明する
    - テスト戦略を提案する

**言語固有の考慮事項:**

**JavaScript/TypeScript:**
- async/awaitとPromise処理を説明する
- クロージャとスコープの動作を説明する
- thisバインディングとアロー関数を明確化する
- イベント処理とコールバックを説明する

**Python:**
- リスト内包表記とジェネレータを説明する
- デコレータの使用と目的を説明する
- コンテキストマネージャとwith文を明確化する
- クラス継承とメソッド解決を説明する

**Java:**
- ジェネリックスと型パラメータを説明する
- アノテーションの使用と処理を説明する
- ストリーム操作とラムダ式を明確化する
- 例外階層と処理を説明する

**C#:**
- LINQクエリと式を説明する
- async/awaitとTask処理を説明する
- delegateとイベントの使用を明確化する
- nullable参照型を説明する

**Go:**
- goroutineとchannelの使用を説明する
- インターフェース実装を説明する
- エラー処理パターンを明確化する
- パッケージ構造とimportを説明する

**Rust:**
- 所有権と借用を説明する
- ライフタイムアノテーションを説明する
- パターンマッチングとOption/Result型を明確化する
- trait実装を説明する

以下を必ず実行してください:
- 可能な限り明確で非技術的な言葉を使用する
- 複雑な概念には例や類推を提供する
- 高レベルから詳細へと論理的に説明を構成する
- 有用な場合は視覚的な図やフローチャートを含める
- 意図された読者に合わせて説明レベルを調整する