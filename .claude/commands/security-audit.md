# セキュリティ監査コマンド

あらゆるコードベースの包括的なセキュリティ分析を実施し、脆弱性とセキュリティベストプラクティスを特定します。

## 実行手順

以下の手順に従って体系的なセキュリティ監査を実行してください：

1. **環境設定**
   - 技術スタックとフレームワークの特定
   - 既存のセキュリティツールと設定のチェック
   - デプロイメントとインフラストラクチャ設定のレビュー

2. **依存関係セキュリティ**
   - 既知の脆弱性についてすべての依存関係をスキャン
   - セキュリティ問題のある古いパッケージのチェック
   - 依存関係のソースと整合性のレビュー
   - 適切なツールの使用：`npm audit`、`pip check`、`cargo audit`等

3. **認証・認可**
   - 認証メカニズムと実装のレビュー
   - 適切なセッション管理のチェック
   - 認可制御とアクセス制限の検証
   - パスワードポリシーと保存方法の検査

4. **入力検証・サニタイゼーション**
   - すべてのユーザー入力の検証とサニタイゼーションのチェック
   - SQLインジェクション脆弱性の探索
   - 潜在的なXSS（Cross-Site Scripting）問題の特定
   - ファイルアップロードのセキュリティと検証のレビュー

5. **データ保護**
   - 機密データの処理方法の特定
   - 保存時および転送時のデータ暗号化実装のチェック
   - データマスキングと匿名化の手法のレビュー
   - セキュアな通信プロトコル（HTTPS、TLS）の検証

6. **シークレット管理**
   - ハードコードされたシークレット、APIキー、パスワードのスキャン
   - 適切なシークレット管理手法のチェック
   - 環境変数のセキュリティのレビュー
   - 露出している設定ファイルの特定

7. **エラーハンドリング・ログ記録**
   - 情報漏洩につながるエラーメッセージのレビュー
   - セキュリティイベントのログ記録方法のチェック
   - 機密データがログに記録されていないことの検証
   - エラーハンドリングの堅牢性の評価

8. **インフラストラクチャセキュリティ**
   - コンテナ化セキュリティ（Docker等）のレビュー
   - CI/CDパイプラインセキュリティのチェック
   - クラウド設定と権限の検査
   - ネットワークセキュリティ設定の評価

9. **セキュリティヘッダー・CORS**
   - セキュリティヘッダー実装のチェック
   - CORS設定のレビュー
   - CSP（Content Security Policy）設定の検証
   - cookieセキュリティ属性の検査

10. **レポート作成**
    - 重要度レベル（緊急、高、中、低）を含むすべての発見事項の文書化
    - 各問題に対する具体的な修正手順の提供
    - コード例とファイル参照の含有
    - 主要な推奨事項を含むエグゼクティブサマリーの作成

利用可能な自動セキュリティスキャンツールを使用し、複雑なセキュリティパターンについては手動レビューを実施してください。