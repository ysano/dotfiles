# „Éá„Éó„É≠„Ç§„É≠„Éº„É´„Éê„ÉÉ„ÇØ„Ç≥„Éû„É≥„Éâ

ÂïèÈ°å„ÅåÊ§úÂá∫„Åï„Çå„ÅüÂ†¥Âêà„Å´„ÄÅ„ÉÄ„Ç¶„É≥„Çø„Ç§„É†„Å®„É¶„Éº„Ç∂„Éº„Å∏„ÅÆÂΩ±Èüø„ÇíÊúÄÂ∞èÈôê„Å´Êäë„Åà„Å™„Åå„Çâ„ÄÅÊú¨Áï™Áí∞Â¢É„ÅÆ„Éá„Éó„É≠„Ç§„ÇíÂÆâÂÖ®„Åã„Å§ËøÖÈÄü„Å´„É≠„Éº„É´„Éê„ÉÉ„ÇØ„Åó„Åæ„Åô„ÄÇ

## ÂÆüË°åÊâãÈ†Ü

„Åì„ÅÆ‰ΩìÁ≥ªÁöÑ„Å™„É≠„Éº„É´„Éê„ÉÉ„ÇØÊâãÈ†Ü„Å´Âæì„Å£„Å¶„Åè„Å†„Åï„ÅÑ: **$ARGUMENTS**

1. **„Ç§„É≥„Ç∑„Éá„É≥„ÉàË©ï‰æ°„Å®Âà§Êñ≠**
   - ÁèæÂú®„ÅÆ„Éá„Éó„É≠„Ç§ÂïèÈ°å„ÅÆÊ∑±ÂàªÂ∫¶„Å®ÂΩ±Èüø„ÇíË©ï‰æ°
   - „É≠„Éº„É´„Éê„ÉÉ„ÇØ„ÅåÂøÖË¶Å„Åã„ÄÅÂâçÈÄ≤‰øÆÊ≠£„ÅåËâØ„ÅÑ„Åã„ÇíÂà§Êñ≠
   - ÂΩ±Èüø„ÇíÂèó„Åë„Çã„Ç∑„Çπ„ÉÜ„É†„ÄÅ„É¶„Éº„Ç∂„Éº„ÄÅ„Éì„Ç∏„Éç„ÇπÊ©üËÉΩ„ÇíÁâπÂÆö
   - „Éá„Éº„ÇøÊï¥ÂêàÊÄß„Å®‰∏ÄË≤†ÊÄß„Å∏„ÅÆÂΩ±Èüø„ÇíËÄÉÊÖÆ
   - Âà§Êñ≠„ÅÆÊ†πÊã†„Å®„Çø„Ç§„É†„É©„Ç§„É≥„ÇíÊñáÊõ∏Âåñ

2. **Á∑äÊÄ•ÂØæÂøú„ÅÆ„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó**
   ```bash
   # „Ç§„É≥„Ç∑„Éá„É≥„ÉàÂØæÂøú„ÉÅ„Éº„É†„ÇíËµ∑Âãï
   # „Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥„ÉÅ„É£„Éç„É´„ÇíË®≠ÂÆö
   # „Çπ„ÉÜ„Éº„ÇØ„Éõ„É´„ÉÄ„Éº„Å´Âç≥Â∫ß„Å´ÈÄöÁü•
   
   # Á∑äÊÄ•ÈÄöÁü•„ÅÆ‰æã
   echo "üö® „É≠„Éº„É´„Éê„ÉÉ„ÇØÈñãÂßã
   ÂïèÈ°å: v1.3.0„Éá„Éó„É≠„Ç§Âæå„ÅÆÈáçË¶Å„Å™„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÂä£Âåñ
   „Ç¢„ÇØ„Ç∑„Éß„É≥: v1.2.9„Å´„É≠„Éº„É´„Éê„ÉÉ„ÇØ‰∏≠
   ‰∫àÂÆöÊôÇÂàª: 15ÂàÜ
   ÂΩ±Èüø: ‰∏ÄÊôÇÁöÑ„Å™„Çµ„Éº„Éì„Çπ‰∏≠Êñ≠„ÅÆÂèØËÉΩÊÄß
   „Çπ„ÉÜ„Éº„Çø„Çπ„ÉÅ„É£„É≥„Éç„É´: #incident-rollback-202401"
   ```

3. **„É≠„Éº„É´„Éê„ÉÉ„ÇØÂâç„ÅÆÂÆâÂÖ®„ÉÅ„Çß„ÉÉ„ÇØ**
   ```bash
   # ÁèæÂú®„ÅÆÊú¨Áï™„Éê„Éº„Ç∏„Éß„É≥„ÇíÁ¢∫Ë™ç
   curl -s https://api.example.com/version
   kubectl get deployments -o wide
   
   # „Ç∑„Çπ„ÉÜ„É†„Çπ„ÉÜ„Éº„Çø„Çπ„Çí„ÉÅ„Çß„ÉÉ„ÇØ
   curl -s https://api.example.com/health | jq .
   
   # „Çø„Éº„Ç≤„ÉÉ„Éà„É≠„Éº„É´„Éê„ÉÉ„ÇØ„Éê„Éº„Ç∏„Éß„É≥„ÇíÁâπÂÆö
   git tag --sort=-version:refname | head -5
   
   # „É≠„Éº„É´„Éê„ÉÉ„ÇØÂØæË±°„ÅåÂ≠òÂú®„Åó„Éá„Éó„É≠„Ç§ÂèØËÉΩ„Åß„ÅÇ„Çã„Åì„Å®„ÇíÁ¢∫Ë™ç
   git show v1.2.9 --stat
   ```

4. **„Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆËÄÉÊÖÆ‰∫ãÈ†Ö**
   ```bash
   # Ââç„Éê„Éº„Ç∏„Éß„É≥„Åã„Çâ„ÅÆ„Éá„Éº„Çø„Éô„Éº„Çπ„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„Çí„ÉÅ„Çß„ÉÉ„ÇØ
   ./check-migrations.sh v1.2.9 v1.3.0
   
   # „Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„ÅåÂ≠òÂú®„Åô„ÇãÂ†¥Âêà„ÄÅ„Éá„Éº„Çø„Éô„Éº„Çπ„É≠„Éº„É´„Éê„ÉÉ„ÇØ„ÇíË®àÁîª
   # Ë≠¶Âëä: „Éá„Éº„Çø„Éô„Éº„Çπ„É≠„Éº„É´„Éê„ÉÉ„ÇØ„ÅØ„Éá„Éº„ÇøÊêçÂ§±„ÇíÂºï„ÅçËµ∑„Åì„ÅôÂèØËÉΩÊÄß
   # „Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„ÅåÂ≠òÂú®„Åô„ÇãÂ†¥Âêà„ÅØÂâçÈÄ≤‰øÆÊ≠£„ÇíÊ§úË®é
   
   # „É≠„Éº„É´„Éê„ÉÉ„ÇØÂâç„Å´„Éá„Éº„Çø„Éô„Éº„Çπ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Çí‰ΩúÊàê
   ./backup-database.sh "pre-rollback-$(date +%Y%m%d-%H%M%S)"
   ```

5. **„Éà„É©„Éï„Ç£„ÉÉ„ÇØÁÆ°ÁêÜ„ÅÆÊ∫ñÂÇô**
   ```bash
   # „Éà„É©„Éï„Ç£„ÉÉ„ÇØ„É™„ÉÄ„Ç§„É¨„ÇØ„Éà„ÅÆÊ∫ñÂÇô
   # „Ç™„Éó„Ç∑„Éß„É≥1: „É°„É≥„ÉÜ„Éä„É≥„Çπ„Éö„Éº„Ç∏
   ./enable-maintenance-mode.sh
   
   # „Ç™„Éó„Ç∑„Éß„É≥2: „É≠„Éº„Éâ„Éê„É©„É≥„Çµ„ÉºÁÆ°ÁêÜ
   ./drain-traffic.sh --gradual
   
   # „Ç™„Éó„Ç∑„Éß„É≥3: „Çµ„Éº„Ç≠„ÉÉ„Éà„Éñ„É¨„Éº„Ç´„ÉºËµ∑Âãï
   ./activate-circuit-breaker.sh
   ```

6. **Container/Kubernetes„É≠„Éº„É´„Éê„ÉÉ„ÇØ**
   ```bash
   # Kubernetes„É≠„Éº„É´„Éê„ÉÉ„ÇØ
   kubectl rollout history deployment/app-deployment
   kubectl rollout undo deployment/app-deployment
   
   # „Åæ„Åü„ÅØÁâπÂÆö„ÅÆ„É™„Éì„Ç∏„Éß„É≥„Å´„É≠„Éº„É´„Éê„ÉÉ„ÇØ
   kubectl rollout undo deployment/app-deployment --to-revision=3
   
   # „É≠„Éº„É´„Éê„ÉÉ„ÇØÈÄ≤Êçó„ÇíÁõ£Ë¶ñ
   kubectl rollout status deployment/app-deployment --timeout=300s
   
   # „Éù„ÉÉ„Éâ„ÅåÂãï‰Ωú„Åó„Å¶„ÅÑ„Çã„Åì„Å®„ÇíÁ¢∫Ë™ç
   kubectl get pods -l app=your-app
   ```

7. **Docker Swarm„É≠„Éº„É´„Éê„ÉÉ„ÇØ**
   ```bash
   # „Çµ„Éº„Éì„ÇπÂ±•Ê≠¥„Çí„É™„Çπ„Éà
   docker service ps app-service --no-trunc
   
   # Ââç„Éê„Éº„Ç∏„Éß„É≥„Å´„É≠„Éº„É´„Éê„ÉÉ„ÇØ
   docker service update --rollback app-service
   
   # „Åæ„Åü„ÅØÁâπÂÆö„ÅÆ„Ç§„É°„Éº„Ç∏„Å´Êõ¥Êñ∞
   docker service update --image app:v1.2.9 app-service
   
   # „É≠„Éº„É´„Éê„ÉÉ„ÇØ„ÇíÁõ£Ë¶ñ
   docker service ps app-service
   ```

8. **‰ºùÁµ±ÁöÑ„Å™„Éá„Éó„É≠„Ç§„É°„É≥„Éà„É≠„Éº„É´„Éê„ÉÉ„ÇØ**
   ```bash
   # Blue-Green„Éá„Éó„É≠„Ç§„É°„É≥„Éà„É≠„Éº„É´„Éê„ÉÉ„ÇØ
   ./switch-to-blue.sh  # „Åæ„Åü„ÅØgreen„ÄÅÁèæÂú®„Å´‰æùÂ≠ò
   
   # „É≠„Éº„É™„É≥„Ç∞„Éá„Éó„É≠„Ç§„É°„É≥„Éà„É≠„Éº„É´„Éê„ÉÉ„ÇØ
   ./deploy-version.sh v1.2.9 --rolling
   
   # „Ç∑„É≥„Éú„É™„ÉÉ„ÇØ„É™„É≥„ÇØ„Éô„Éº„Çπ„É≠„Éº„É´„Éê„ÉÉ„ÇØ
   ln -sfn /releases/v1.2.9 /current
   sudo systemctl restart app-service
   ```

9. **„É≠„Éº„Éâ„Éê„É©„É≥„Çµ„Éº„Å®CDN„ÅÆÊõ¥Êñ∞**
   ```bash
   # „É≠„Éº„Éâ„Éê„É©„É≥„Çµ„Éº„ÇíÊóß„Éê„Éº„Ç∏„Éß„É≥„Å´Âêë„Åë„Çã„Çà„ÅÜÊõ¥Êñ∞
   aws elbv2 modify-target-group --target-group-arn $TG_ARN --targets Id=old-instance
   
   # ÂøÖË¶Å„Å´Âøú„Åò„Å¶CDN„Ç≠„É£„ÉÉ„Ç∑„É•„Çí„ÇØ„É™„Ç¢
   aws cloudfront create-invalidation --distribution-id $DIST_ID --paths \"/*\"
   
   # ÂøÖË¶Å„Å´Âøú„Åò„Å¶DNS„ÇíÊõ¥Êñ∞ÔºàÊúÄÂæå„ÅÆÊâãÊÆµ„ÄÅ‰ºùÊí≠ÈÅÖÂª∂„ÅÇ„ÇäÔºâ
   # aws route53 change-resource-record-sets ...
   ```

10. **Ë®≠ÂÆö„ÅÆ„É≠„Éº„É´„Éê„ÉÉ„ÇØ**
    ```bash\n    # Rollback configuration files\n    git checkout v1.2.9 -- config/\n    \n    # Restart services with old configuration\n    sudo systemctl restart nginx\n    sudo systemctl restart app-service\n    \n    # Rollback environment variables\n    ./restore-env-vars.sh v1.2.9\n    \n    # Update feature flags\n    ./update-feature-flags.sh --disable-new-features\n    ```\n\n11. **„Éá„Éº„Çø„Éô„Éº„Çπ„É≠„Éº„É´„Éê„ÉÉ„ÇØÔºàÂøÖË¶Å„Å™Â†¥ÂêàÔºâ**\n    ```sql\n    -- EXTREME CAUTION: Can cause data loss\n    \n    -- Check migration status\n    SELECT * FROM schema_migrations ORDER BY version DESC LIMIT 5;\n    \n    -- Rollback specific migrations (framework dependent)\n    -- Rails: rake db:migrate:down VERSION=20240115120000\n    -- Django: python manage.py migrate app_name 0001\n    -- Node.js: npm run migrate:down\n    \n    -- Verify database state\n    SHOW TABLES;\n    DESCRIBE critical_table;\n    ```\n\n12. **Service Health Validation**\n    ```bash\n    # Health check script\n    #!/bin/bash\n    \n    echo \"Validating rollback...\"\n    \n    # Check application health\n    if curl -f -s https://api.example.com/health > /dev/null; then\n        echo \"‚úÖ Health check passed\"\n    else\n        echo \"‚ùå Health check failed\"\n        exit 1\n    fi\n    \n    # Check critical endpoints\n    endpoints=(\n        \"/api/users/me\"\n        \"/api/auth/status\"\n        \"/api/data/latest\"\n    )\n    \n    for endpoint in \"${endpoints[@]}\"; do\n        if curl -f -s \"https://api.example.com$endpoint\" > /dev/null; then\n            echo \"‚úÖ $endpoint working\"\n        else\n            echo \"‚ùå $endpoint failed\"\n        fi\n    done\n    ```\n\n13. **Performance and Metrics Validation**\n    ```bash\n    # Check response times\n    curl -w \"Response time: %{time_total}s\\n\" -s -o /dev/null https://api.example.com/\n    \n    # Monitor error rates\n    tail -f /var/log/app/error.log | head -20\n    \n    # Check system resources\n    top -bn1 | head -10\n    free -h\n    df -h\n    \n    # Validate database connectivity\n    mysql -u app -p -e \"SELECT 1;\"\n    ```\n\n14. **Traffic Restoration**\n    ```bash\n    # Gradually restore traffic\n    ./restore-traffic.sh --gradual\n    \n    # Disable maintenance mode\n    ./disable-maintenance-mode.sh\n    \n    # Re-enable circuit breakers\n    ./deactivate-circuit-breaker.sh\n    \n    # Monitor traffic patterns\n    ./monitor-traffic.sh --duration 300\n    ```\n\n15. **Monitoring and Alerting**\n    ```bash\n    # Enable enhanced monitoring during rollback\n    ./enable-enhanced-monitoring.sh\n    \n    # Watch key metrics\n    watch -n 10 'curl -s https://api.example.com/metrics | jq .'\n    \n    # Monitor logs in real-time\n    tail -f /var/log/app/*.log | grep -E \"ERROR|WARN|EXCEPTION\"\n    \n    # Check application metrics\n    # - Response times\n    # - Error rates\n    # - User sessions\n    # - Database performance\n    ```\n\n16. **User Communication**\n    ```markdown\n    ## Service Update - Rollback Completed\n    \n    **Status:** ‚úÖ Service Restored\n    **Time:** 2024-01-15 15:45 UTC\n    **Duration:** 12 minutes of degraded performance\n    \n    **What Happened:**\n    We identified performance issues with our latest release and \n    performed a rollback to ensure optimal service quality.\n    \n    **Current Status:**\n    - All services operating normally\n    - Performance metrics back to baseline\n    - No data loss occurred\n    \n    **Next Steps:**\n    We're investigating the root cause and will provide updates \n    on our status page.\n    ```\n\n17. **Post-Rollback Validation**\n    ```bash\n    # Extended monitoring period\n    ./monitor-extended.sh --duration 3600  # 1 hour\n    \n    # Run integration tests\n    npm run test:integration:production\n    \n    # Check user-reported issues\n    ./check-support-tickets.sh --since \"1 hour ago\"\n    \n    # Validate business metrics\n    ./check-business-metrics.sh\n    ```\n\n18. **Documentation and Reporting**\n    ```markdown\n    # Rollback Incident Report\n    \n    **Incident ID:** INC-2024-0115-001\n    **Rollback Version:** v1.2.9 (from v1.3.0)\n    **Start Time:** 2024-01-15 15:30 UTC\n    **End Time:** 2024-01-15 15:42 UTC\n    **Total Duration:** 12 minutes\n    \n    **Timeline:**\n    - 15:25 - Performance degradation detected\n    - 15:30 - Rollback decision made\n    - 15:32 - Traffic drained\n    - 15:35 - Rollback initiated\n    - 15:38 - Rollback completed\n    - 15:42 - Traffic fully restored\n    \n    **Impact:**\n    - 12 minutes of degraded performance\n    - ~5% of users experienced slow responses\n    - No data loss or corruption\n    - No security implications\n    \n    **Root Cause:**\n    Memory leak in new feature causing performance degradation\n    \n    **Lessons Learned:**\n    - Need better performance testing in staging\n    - Improve monitoring for memory usage\n    - Consider canary deployments for major releases\n    ```\n\n19. **Cleanup and Follow-up**\n    ```bash\n    # Clean up failed deployment artifacts\n    docker image rm app:v1.3.0\n    \n    # Update deployment status\n    ./update-deployment-status.sh \"rollback-completed\"\n    \n    # Reset feature flags if needed\n    ./reset-feature-flags.sh\n    \n    # Schedule post-incident review\n    ./schedule-postmortem.sh --date \"2024-01-16 10:00\"\n    ```\n\n20. **Prevention and Improvement**\n    - Analyze what went wrong with the deployment\n    - Improve testing and validation procedures\n    - Enhance monitoring and alerting\n    - Update rollback procedures based on learnings\n    - Consider implementing canary deployments\n\n**Rollback Decision Matrix:**\n\n| Issue Severity | Data Impact | Time to Fix | Decision |\n|---------------|-------------|-------------|----------|\n| Critical | None | > 30 min | Rollback |\n| High | Minor | > 60 min | Rollback |\n| Medium | None | > 2 hours | Consider rollback |\n| Low | None | Any | Forward fix |\n\n**Emergency Rollback Script Template:**\n```bash\n#!/bin/bash\nset -e\n\n# Emergency rollback script\nPREVIOUS_VERSION=\"${1:-v1.2.9}\"\nCURRENT_VERSION=$(curl -s https://api.example.com/version)\n\necho \"üö® EMERGENCY ROLLBACK\"\necho \"From: $CURRENT_VERSION\"\necho \"To: $PREVIOUS_VERSION\"\necho \"\"\n\n# Confirm rollback\nread -p \"Proceed with rollback? (yes/no): \" confirm\nif [ \"$confirm\" != \"yes\" ]; then\n    echo \"Rollback cancelled\"\n    exit 1\nfi\n\n# Execute rollback\necho \"Starting rollback...\"\nkubectl set image deployment/app-deployment app=app:$PREVIOUS_VERSION\nkubectl rollout status deployment/app-deployment --timeout=300s\n\n# Validate\necho \"Validating rollback...\"\nsleep 30\ncurl -f https://api.example.com/health\n\necho \"‚úÖ Rollback completed successfully\"\n```\n\nÊ≥®ÊÑè: „É≠„Éº„É´„Éê„ÉÉ„ÇØ„ÅØÊúÄÂæå„ÅÆÊâãÊÆµ„Åß„ÅÇ„Çã„Åπ„Åç„Åß„Åô„ÄÇÁâπ„Å´„Éá„Éº„Çø„Éô„Éº„Çπ„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„ÅåÈñ¢„Çè„ÇãÂ†¥Âêà„ÅØ„ÄÅÂ∏∏„Å´ÂâçÈÄ≤‰øÆÊ≠£„ÇíÊúÄÂàù„Å´Ê§úË®é„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ