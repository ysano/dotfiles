# セキュリティハードニング

アプリケーションスタック全体にわたって攻撃対象領域を削減し、セキュリティポスチャを向上させるための包括的なセキュリティベストプラクティスを適用します。

## 実行手順

1. **セキュリティ評価とベースライン**
   - 現在のアプリケーションの包括的なセキュリティ監査を実施
   - 潜在的な脆弱性と攻撃ベクトルを特定
   - 認証・認可メカニズムの分析
   - データハンドリングと保存手法のレビュー
   - ネットワークセキュリティと通信プロトコルの評価

2. **認証・認可のハードニング**
   - 強力なパスワードポリシーと多要素認証の実装
   - 適切なタイムアウト設定でのセキュアなセッション管理の構成
   - 最小権限の原則に基づく役割ベースアクセス制御（RBAC）の設定
   - JWTセキュリティベストプラクティスまたはセキュアなセッショントークンの実装
   - アカウントロックアウトとブルートフォース攻撃保護の構成

3. **入力検証とサニタイゼーション**
   - すべてのユーザー入力に対する包括的な入力検証の実装
   - パラメータ化クエリによるSQLインジェクション対策の設定
   - 適切な出力エンコーディングによるXSS保護の構成
   - トークンとSameSite cookieによるCSRF保護の実装
   - タイプ検証とサンドボックス化によるファイルアップロードセキュリティの設定

4. **セキュア通信**
   - 強力なTLS/SSL証明書によるHTTPSの構成
   - HTTP Strict Transport Security（HSTS）の実装
   - 適切な認証によるセキュアなAPI通信の設定
   - モバイルアプリケーション向け証明書ピニングの構成
   - 機密データ転送のためのエンドツーエンド暗号化の実装

5. **データ保護と暗号化**
   - 機密データの保存時暗号化の実装
   - セキュアなキー管理とローテーションの構成
   - データベース暗号化とアクセス制御の設定
   - 適切なシークレット管理の実装（ハードコードシークレットの回避）
   - セキュアなバックアップと復旧手順の構成

6. **セキュリティヘッダーとポリシー**
   - Content Security Policy（CSP）ヘッダーの構成
   - X-Frame-OptionsおよびX-Content-Type-Optionsヘッダーの設定
   - Referrer PolicyおよびFeature Policyヘッダーの実装
   - 適切なオリジン検証によるCORSポリシーの構成
   - 責任ある脆弱性開示のためのsecurity.txtファイルの設定

7. **依存関係とサプライチェーンセキュリティ**
   - すべての依存関係の最新セキュアバージョンへの監査と更新
   - 依存関係脆弱性スキャンの実装
   - 重要な依存関係の自動セキュリティ更新の構成
   - ソフトウェア構成分析（SCA）ツールの設定
   - 依存関係のピニングと整合性チェックの実装

8. **インフラストラクチャセキュリティ**
   - ファイアウォールルールとネットワークセグメンテーションの構成
   - 侵入検知・防止システムの実装
   - セキュアなログ記録と監視の設定
   - セキュアなコンテナイメージとランタイムセキュリティの構成
   - Infrastructure as Codeセキュリティスキャンの実装

9. **アプリケーションセキュリティ制御**
   - レート制限とDDoS保護の実装
   - Webアプリケーションファイアウォール（WAF）ルールの設定
   - 情報漏洩のないセキュアなエラーハンドリングの構成
   - セキュリティイベントの適切なログ記録の実装
   - セキュリティ監視とアラートの設定

10. **セキュリティテストと検証**
    - ペネトレーションテストと脆弱性評価の実施
    - CI/CDパイプラインでの自動セキュリティテストの実装
    - 静的アプリケーションセキュリティテスト（SAST）の設定
    - 動的アプリケーションセキュリティテスト（DAST）の構成
    - セキュリティインシデント対応計画と手順の策定
    - セキュリティ制御とコンプライアンス要件の文書化