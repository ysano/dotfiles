# WSL-specific tmux settings
# Windows Subsystem for Linux environment optimizations

# WSL環境でのクリップボード連携
if-shell 'command -v clip.exe' 'bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "clip.exe"'
if-shell 'command -v clip.exe' 'bind-key -T copy-mode C-w send-keys -X copy-pipe-and-cancel "clip.exe"'

# Load common settings
source-file ~/.tmux/shared/claude-voice-common.conf
source-file ~/.tmux/shared/performance-common.conf  
source-file ~/.tmux/shared/window-status-common.conf

# WSL固有のステータスバー設定 (充実版)
# WSL版とディスク使用量、CPU使用率、ネットワーク情報を含む
set -g status-right "#[fg=colour238,bg=colour235]#[fg=colour250,bg=colour238] 💻 #(lsb_release -rs 2>/dev/null || echo 'WSL') #[fg=yellow,bold]⚡ #(cat /proc/loadavg | cut -d ' ' -f 1-3)#[default] #[fg=cyan]🧠 #(free | awk 'NR==2{printf \"%.0f%%\", $3*100/$2}')#[default] #[fg=green]💾 #(df -h / | awk 'NR==2{print $5}')#[default] #[fg=colour117,bg=colour238]#[fg=colour235,bg=colour117,bold] %m/%d(%a) %H:%M "
set -g status-right-length 120

# WSL環境でのターミナル設定
set-option -g default-terminal "tmux-256color"
set-option -sa terminal-overrides ",xterm*:Tc"
set-option -sa terminal-overrides ",WSL*:Tc"

# WSL-specific terminal settings

# WSL環境でのセッション永続化
set -g @continuum-save-interval '15'  # 15分間隔で自動保存

# WSL-specific environment variables
set-environment -g WSL_INTEGRATION 'enabled'
set-environment -g WINDOWS_HOST_PATH '/mnt/c'

# WSL-specific utility keybindings
# Open Windows Explorer at current directory
bind-key C-e run-shell 'explorer.exe .'

# Copy current path to Windows clipboard
bind-key C-p run-shell 'pwd | tr -d "\\n" | clip.exe && tmux display-message "Path copied to Windows clipboard"'

# WSL-specific performance optimizations
set -g history-limit 50000     # Larger buffer for development work
set -g display-time 3000       # Longer display time for WSL
set -g display-panes-time 3000

# WSL clipboard integration improvements
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "clip.exe"
bind-key -T copy-mode MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "clip.exe"

# WSL-specific development helpers
# Quick access to Windows user directory
bind-key C-w run-shell 'cd /mnt/c/Users/$USER 2>/dev/null || cd /mnt/c/Users/$(whoami) 2>/dev/null || tmux display-message "Windows user dir not found"'

# Git status in current directory
bind-key C-g run-shell 'cd #{pane_current_path} && git status --porcelain | head -10 | tmux display-message "$(cat)"'