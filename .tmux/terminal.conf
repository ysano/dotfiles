# Terminal-specific settings for proper key handling

# Escape time: 0 for local (fast Alt key response), increase for SSH
set -s escape-time 0

# Extended keys (tmux 3.2+): C-1, C-; 等の追加キーを認識
set -s extended-keys on
set -as terminal-features 'xterm*:extkeys'

# Fallback for tmux < 3.2 (extended-keys 未対応時は無視される)
set -gq xterm-keys on

# Focus events (エディタのフォーカス検出に必要)
set -s focus-events on

# macOS + iTerm2: Meta/Alt key + RGB + clipboard + italics
if-shell 'test "$(uname)" = "Darwin"' \
  'set -as terminal-features ",xterm-256color:RGB:clipboard"; \
   set -as terminal-overrides ",xterm*:Tc"; \
   set -as terminal-overrides ",xterm*:sitm=\\E[3m:ritm=\\E[23m"; \
   set -as terminal-overrides ",xterm*:smso=\\E[7m:rmso=\\E[27m"; \
   set -as terminal-overrides ",xterm*:smul=\\E[4m:rmul=\\E[24m"'
